<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redectio ‚Äì COA Redaction Tool</title>

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css">

  <!-- App entry -->
  <script type="module" src="./app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
  <div id="alertContainer"></div>

  <div class="app-root">

    <!-- Sidebar -->
    <aside class="sidebar">

      <!-- User badge at top -->
      <div class="sidebar-user">
        <span class="badge">Rasesh Pradhan</span>
      </div>

      <nav class="sidebar-nav">
        <button class="nav-item nav-item-active">
          <span class="nav-icon">üìÑ</span>
          <span class="nav-label">Redact COA</span>
        </button>
        <button class="nav-item" disabled>
          <span class="nav-icon">üìö</span>
          <span class="nav-label">Batch (coming)</span>
        </button>
        <button class="nav-item" disabled>
          <span class="nav-icon">‚öôÔ∏è</span>
          <span class="nav-label">Settings (coming)</span>
        </button>
      </nav>

      <!-- 1. Upload Panel -->
            <section class="panel-section" id="uploadSection">
              <h3 class="section-title">1. Upload Panel</h3>
              <!-- <p class="section-subtitle">Select or drop a PDF to begin.</p>-->

              <div id="dropZone" class="dropzone">
                <input id="fileInput" type="file" accept="application/pdf" class="dropzone-input" />
                <div class="dropzone-inner">
                  <!-- <div class="dropzone-icon">‚¨ÜÔ∏è</div>-->
                  <div class="dropzone-text-main">Drop or click to select PDF</div>
                  <div class="dropzone-text-sub">Only PDF files are supported</div>
                  <div id="fileName" class="dropzone-filename"></div>
                </div>
              </div>

              <div class="panel-actions">
                <button id="btnRedact" class="btn btn-primary" disabled>Apply Manual Redactions</button>
                <button id="btnClear" class="btn btn-ghost">Clear</button>

                <!-- NEW: Backend Template Detection -->
                <!-- <button id="btnDetectTemplate" class="btn btn-ghost btn-small">Detect Template</button>-->

                <!-- NEW: Batch Redaction Trigger -->
                <!-- <button id="btnBatchRedact" class="btn btn-ghost btn-small">Batch Redact</button>-->
              </div>

              <div id="statusText" class="status-text"></div>
            </section>

      <div class="sidebar-footer">
        <div class="footer-title">Templates</div>
              <div class="sidebar-footer">
        
        <!-- NEW: Company selector -->
        <div class="field-label" style="margin-top: 6px;">Detected company</div>
        <select id="companySelect" class="input-text" style="width: 100%; margin-bottom: 8px;">
          <option value="">(none)</option>
        </select>

        <ul id="templateList" class="template-list"></ul>

        <!-- NEW: Template Sidebar Container -->
        <div id="templateSidebar" class="template-sidebar"></div>

        <!-- Inline template buttons -->
        <div class="template-footer-actions inline-actions">
          <button id="btnSaveTemplate" class="btn btn-ghost btn-small">Save</button>
          <button id="btnLoadTemplate" class="btn btn-ghost btn-small">Refresh</button>
        </div>
      </div>
        <div class="field-label">Redaction Map</div>
        <div class="btn-row">
          <button id="btnExportRedactions" class="btn btn-ghost btn-small">Export JSON</button>
          <button id="btnImportRedactions" class="btn btn-ghost btn-small">Import JSON</button>
          <input id="importRedactionsInput" type="file" accept="application/json" class="hidden-input" />
        </div>
    </aside>

    <!-- Main layout -->
    <div class="main">

      <!-- Centered Top Bar -->
      <header class="topbar">
        <div class="topbar-center">
          <!--<div class="logo-circle">R</div>-->
          <h1 class="topbar-title">Rasesh COA Redaction Tool</h1>
          <span class="topbar-subtitle">Auto-detect company ¬∑ Auto-redact ¬∑ Manual fine-tune</span>
        </div>
      </header>

      <!-- Content -->
      <main class="content">
        <div class="workspace">

          <!-- LEFT PANEL -->
          <aside class="left-panel">

            <!-- 2. Navigation Tools -->
            <section class="panel-section" id="navigationSection">
              <h3 class="section-title">2. Navigation Tools</h3>
              <p class="section-subtitle">Search and highlight content across pages.</p>

              <label class="field-label" for="searchInput">Search text</label>

              <!-- Search + suggestions -->
              <div class="search-row" style="position: relative;">
                <input id="searchInput" class="input-text" type="text" placeholder="Search in document..." />
                <div id="searchSuggestions" class="suggestions hidden"></div>
              </div>

              <div class="inline-row">
                <button id="btnSearchPrev" class="btn btn-ghost btn-small">Prev</button>
                <button id="btnSearchNext" class="btn btn-ghost btn-small">Next</button>
                <span id="searchInfo" class="info-pill">0 / 0</span>
              </div>

              <div class="inline-row">
                <button id="btnSearchRedactAll" class="btn btn-ghost btn-small">Redact All Matches</button>
              </div>

              <div class="inline-row">
                <button id="btnToggleHighlight" class="btn btn-ghost btn-small">Highlight Mode</button>
              </div>
            </section>

            <!-- 3. Redaction Tools -->
            <section class="panel-section" id="redactionSection">
              <h3 class="section-title">3. Redaction Tools</h3>
              <p class="section-subtitle">Choose redaction mode and manage suggestions.</p>

              <div class="field-label">Redaction mode</div>
              <div class="btn-row">
                <button id="btnModeSelectText" class="btn btn-toggle btn-small">Text Selection</button>
                <button id="btnModeDrawBox" class="btn btn-toggle btn-small btn-toggle-active">Box Redaction</button>
                <button id="btnAutoBarcodes" class="btn btn-sm">
                  <i class="fa-solid fa-barcode"></i>
                </button>
              </div>

              <div class="inline-row">
                <button id="btnUndo" class="btn btn-ghost btn-small">Undo</button>
                <button id="btnRedo" class="btn btn-ghost btn-small">Redo</button>
              </div>

              <div class="field-label">Auto‚ÄëRedaction</div>
              <div class="dropdown">
                <button id="btnAutoRedactMenu" class="btn btn-primary btn-small dropdown-toggle">Auto‚ÄëRedact ‚ñº</button>
                <div id="autoRedactDropdown" class="dropdown-menu hidden">
                  <button id="btnAutoTemplate" class="dropdown-item">Template Auto‚ÄëRedact</button>
                  <button id="btnAutoPatterns" class="dropdown-item">Pattern Auto‚ÄëRedact</button>
                  <button id="btnAutoOCR" class="dropdown-item">OCR Auto‚ÄëRedact</button>
                </div>
              </div>

              <!-- NEW: General Auto Suggest -->
              <div class="inline-row">
                <button id="btnAutoSuggest" class="btn btn-primary btn-small">Auto Suggest</button>
              </div>

              <div class="inline-row">
                <button id="btnAutoApply" class="btn btn-ghost btn-small" disabled>Apply Suggestions</button>
                <button id="btnAutoClear" class="btn btn-ghost btn-small" disabled>Clear Suggestions</button>
              </div>

              <div class="field-label">Page Redaction</div>
              <div class="btn-row">
                <button id="btnRedactCurrentPage" class="btn btn-ghost btn-small">Redact Current Page</button>
              </div>

              <div class="field-label">Redaction Color</div>
              <div class="color-row">
                <input id="redactionColor" type="color" value="#000000" />
                <span class="color-label">Current color</span>
              </div>

              <div class="field-label">Review Mode</div>
              <div class="btn-row">
                <button id="btnReviewMode" class="btn btn-ghost btn-small">Toggle Review Mode</button>
                <button id="btnShowOnlyAuto" class="btn btn-ghost btn-small">Show Only Auto</button>
              </div>
            </section>
          </aside>

          <!-- RIGHT PANEL: PDF VIEWER -->
          <section class="viewer-panel">

            <!-- Centered page jump -->
            <div class="viewer-header" style="justify-content:center;">
              <div class="page-jump">
                <input id="pageInput" type="number" min="1" value="1" />
                <span id="pageTotal">/ 0</span>
              </div>
            </div>

            <div class="pdf-scroll-container">
              <div id="pdfPagesColumn" class="pdf-pages-column"></div>
            </div>
          </section>

        </div>
      </main>
    </div>
  </div>
</body>
</html>
